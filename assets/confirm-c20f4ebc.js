import{d as be,M as ge,a1 as xe,r as b,al as ke,O as Q,w as S,a as he,a8 as ye,l as U,y as l,Q as $e,v as t,z as n,q as _,f as c,H as p,P as Z,aU as we,aV as Te,k as y,x as Ce,C as v,V as A,F as ee,E as O,a6 as te,G as oe,I as E,W as Fe,X as Ae,aW as g,aX as Be,aY as Ve,a2 as le,aZ as ne,a_ as Ie,T as Oe,a$ as qe,J as Se,_ as Ue}from"./index-1f7c36f7.js";import{I as Ee}from"./index-590f676d.js";import{g as Ne}from"./trader-c434a54f.js";import{g as He,a as Me,b as De,c as Le,r as Pe,s as ze}from"./index-b8105b6e.js";import{S as se}from"./selectToken-ac5cab89.js";const N=B=>(Fe("data-v-ee46314e"),B=B(),Ae(),B),Re={class:"confirm-container"},je={class:"pl-16px pr-16px"},Ge={class:"card-container"},We={class:"flex items-center"},Xe={class:"w-24px h-24px mr-5px",alt:"",srcset:""},Ye={class:"text-14px color-#fff font-500"},Je=N(()=>l("span",{class:"flex-1"},null,-1)),Ke={class:"mt-10px"},Qe={class:"text-16px font-500 color-#fff"},Ze={class:"flex text-12px color-#fff opacity-50 mt-5px"},et={class:"mr-10px"},tt={class:"flex items-center justify-between mt-8px text-14px color-#fff mt-10px"},ot={class:"text-12px opacity-50 mt-3px"},lt={class:"text-12px opacity-50 mt-3px"},nt={class:"text-right"},st={class:"text-12px opacity-50 mt-3px"},at={class:"text-14px color-#333 flex items-center mt-16px mb-10px"},it={class:"mr-5px"},rt=N(()=>l("span",{class:"flex-1"},null,-1)),ct={class:"text-12px color-#999 font-400"},ut={class:"flex items-center"},mt={class:"text-14px color-#333 flex items-center mt-25px mb-10px"},pt={class:"mr-5px"},dt={class:"flex items-center"},ft={class:"text-14px color-#333 flex items-center mt-25px mb-10px"},_t={class:"mr-5px"},vt={class:"flex items-center btn-container"},bt={class:"flex-1 inline-flex justify-center items-center"},gt=N(()=>l("span",{class:"flex-1"},"%",-1)),xt={class:"flex items-center"},kt={class:"text-14px color-#333 flex items-center mt-25px mb-10px"},ht={class:"mr-5px"},yt={class:"flex items-center"},$t={class:"text-14px color-#333 flex items-center mt-25px mb-10px"},wt={class:"mr-5px"},Tt={class:"flex items-center btn-container"},Ct={class:"flex-1 text-center opacity-50"},Ft={class:"flex items-center justify-center text-12px color-#333 font-400 mt-36px"},At={class:"text-14px font-400 p-20px lh-20px"},Bt={class:"text-center text-16px font-500 mb-20px"},Vt={class:"mb-40px"},It={class:"mb-5px"},Ot={class:"mb-5px"},qt={class:"mb-5px"},St={class:"color-#ed6a0c"},Ut=be({__name:"confirm",setup(B){let{t:V}=ge();const H=new URL("/assets/icon-unknown-4090888e.svg",self.location).href;let $=xe(),u=b(null);function q(){let e=$.params.id;Ne(e).then(o=>{console.log(o),u.value=o,me()})}let r=ke({single_amount:"",total_amount:"",slippage:50});function M(e){e===0?r.slippage--:e===1&&r.slippage++}let w=b(!1);function ae(){w.value=!0}let a=b({token:"",decimals:18,symbol:"",balance:0,name:""}),d=b([]),ie=Q(()=>{let e=a.value.balance||0,o=new g(r.single_amount||0).lte(new g(e))&&new g(r.total_amount||0).lte(new g(e));return!e||!o?V("insufficientBalance"):""}),re=Q(()=>{let e=a.value.token,o=a.value.balance||0,s=new g(r.single_amount||0).lte(new g(o))&&new g(r.total_amount||0).lte(new g(o));return!e||!o||!s});S(a,()=>{a.value.token&&D()});function D(){a.value.token&&He(a.value.token,a.value.decimals).then(e=>{a.value.balance=e,d.value=d.value.map(o=>new RegExp(a.value.token,"i").test(o.token)?{...o,balance:e}:o)})}function ce(){Me().then(e=>{var o,s,m;if(console.log(e),d.value=(o=e||[])==null?void 0:o.map(k=>({...k,token:(k.token||Be).toLowerCase()})),(e==null?void 0:e.length)>0){let k=((m=(s=d.value)==null?void 0:s.find)==null?void 0:m.call(s,C=>/weth/i.test(C.symbol)))||d.value[0];ue(),a.value=k}console.log("my tokens",e)}).catch(e=>{console.log(e)})}function ue(){let e=d.value.map(o=>o.token);(e==null?void 0:e.length)>0&&De(e).then(o=>{d.value=d.value.map((s,m)=>o[m]!==null?{...s,balance:o[m]||"0"}:{...s})})}let T=b(!1),f=b(null);function me(){var o;let e=(o=u==null?void 0:u.value)==null?void 0:o.address;e&&Le(e).then(s=>{console.log("queryHasCopyTrade",s),T.value=(s==null?void 0:s.has)||!1,T.value&&(f.value=s.request)})}function pe(){var o;let e=(o=f.value)==null?void 0:o.id;e&&Ve({title:"",message:V("confirmCancelOrder")}).then(()=>{x.value=!0,Pe(e).then(s=>{console.log("removeTrade",s),s&&(le({message:V("cancelOrderSuccessful"),position:"top"}),q())}).catch(s=>{console.log(s),ne(s)}).finally(()=>{x.value=!1})}).catch(()=>{})}let x=b(!1);function de(){var e;if(!T.value){let o={trader_id:((e=u.value)==null?void 0:e.id)||$.params.id||"",single_amount:r.single_amount,total_amount:r.total_amount,slippage:r.slippage,token:a.value.token};x.value=!0,ze(o).then(s=>{le({message:V("addedSuccessfully"),position:"top"}),w.value=!1,q()}).catch(s=>{console.log(s),ne(s)}).finally(()=>{x.value=!1})}}S(()=>$.params.id,()=>{$.params.id&&$.name==="TraderConfirm"&&L()});let I=b({tokenAmount:"0",uAmount:"0",ethAmount:"0"});S(()=>a.value.token,()=>{a.value.token&&Ie(a.value.token).then(e=>{I.value=e})});function L(){u.value=null,q(),ce(),D()}return he(()=>{L()}),(e,o)=>{var P,z,R,j,G,W,X;const s=Oe,m=qe,k=Ee,C=Se,fe=we,_e=Te,ve=ye("lazy");return y(),U("div",Re,[l("div",je,[l("div",Ge,[l("div",We,[$e(l("img",Xe,null,512),[[ve,(P=t(u))==null?void 0:P.headurl]]),l("span",Ye,n(((z=t(u))==null?void 0:z.name)||""),1),Je,l("button",{class:"text-12px color-#ffffff88 clickable",type:"button",onClick:o[0]||(o[0]=_(h=>t(Ce)(t($).params.id),["stop"]))},n(e.$t("TaMain"))+">",1)]),l("div",Ke,[l("div",null,[l("div",Qe,n(t(v)(((R=t(u))==null?void 0:R.earn_30_rate)||0))+"%",1),l("div",Ze,[l("span",et,n(e.$t("last30DaysYield")),1),l("span",null,n(e.$t("winRate"))+" "+n(t(v)(((j=t(u))==null?void 0:j.win_rate)||0))+"%",1)])])]),l("ul",tt,[l("li",null,[l("div",null,"$"+n(t(v)(((G=t(u))==null?void 0:G.earn_copy_trade)||0)),1),l("div",ot,n(e.$t("followerBenefits")),1)]),l("li",null,[l("div",null,"$"+n(t(v)(((W=t(u))==null?void 0:W.amount_copy_trade)||0)),1),l("div",lt,n(e.$t("capitalScale")),1)]),l("li",nt,[l("div",null,n(t(v)(((X=t(u))==null?void 0:X.doc_count)||0)),1),l("div",st,n(e.$t("followers")),1)])])]),c(fe,{onSubmit:ae},{default:p(()=>{var h,Y,J;return[l("div",at,[l("span",it,n(e.$t("limitSingleFollowOrderAmount")),1),c(s,{name:"question-o",class:"clickable",onClick:o[1]||(o[1]=_(i=>t(A)({message:e.$t("limitSingleFollowOrderAmountTips"),confirmButtonText:e.$t("confirm"),confirmButtonColor:"#3F80F7"}),["stop"])),color:"#999"}),rt,l("span",ct,n(e.$t("balance"))+": "+n(t(v)(t(a).balance||0)),1)]),t(T)?(y(),U(ee,{key:1},[c(m,{class:"input-container",type:"number","model-value":(h=t(f))==null?void 0:h.single_amount,center:"",clearable:"","input-align":"right",disabled:""},{label:p(()=>{var i,F;return[l("div",xt,[c(se,{tokens:t(d),token:{token:(i=t(f))==null?void 0:i.token,symbol:(F=t(f))==null?void 0:F.symbol},disabled:""},null,8,["tokens","token"])])]}),_:1},8,["model-value"]),l("div",kt,[l("span",ht,n(e.$t("followTotalAmountLimit")),1),c(s,{name:"question-o",class:"clickable",onClick:o[12]||(o[12]=_(i=>t(A)({message:e.$t("limitTotalAmountTips"),confirmButtonText:e.$t("confirm"),confirmButtonColor:"#3F80F7"}),["stop"])),color:"#999"})]),c(m,{class:"input-container",type:"number","model-value":(Y=t(f))==null?void 0:Y.total_amount,center:"",clearable:"","input-align":"right",disabled:""},{label:p(()=>{var i,F,K;return[l("div",yt,[t(a).token?(y(),O(k,{key:0,class:"w-[20px] h-[20px] mr-5px",round:"","lazy-load":"",src:t(te)({token:(i=t(f))==null?void 0:i.token,symbol:(F=t(f))==null?void 0:F.symbol}),"error-icon":t(H)},null,8,["src","error-icon"])):oe("",!0),l("span",null,n(((K=t(f))==null?void 0:K.symbol)||""),1)])]}),_:1},8,["model-value"]),l("div",$t,[l("span",wt,n(e.$t("followUpPriceFluctuation")),1),c(s,{name:"question-o",class:"clickable",color:"#999",onClick:o[13]||(o[13]=_(i=>t(A)({message:e.$t("followUpPriceFluctuationTips"),confirmButtonText:e.$t("confirm"),confirmButtonColor:"#3F80F7"}),["stop"]))})]),l("div",Tt,[l("div",Ct,n((J=t(f))==null?void 0:J.slippage)+"%",1)])],64)):(y(),U(ee,{key:0},[c(m,{class:"input-container",type:"number",modelValue:t(r).single_amount,"onUpdate:modelValue":o[4]||(o[4]=i=>t(r).single_amount=i),rules:[{required:!0,message:e.$t("pleaseEnter")}],center:"",clearable:"","input-align":"right",placeholder:e.$t("pleaseEnter")},{label:p(()=>[l("div",ut,[c(se,{tokens:t(d),token:t(a),"onUpdate:token":o[2]||(o[2]=i=>Z(a)?a.value=i:a=i)},null,8,["tokens","token"])])]),button:p(()=>[l("button",{class:"text-14px color-#3F80F7 clickable",type:"button",onClick:o[3]||(o[3]=i=>t(r).single_amount=t(a).balance||0)},n(e.$t("max")),1)]),_:1},8,["modelValue","rules","placeholder"]),l("div",mt,[l("span",pt,n(e.$t("followTotalAmountLimit")),1),c(s,{name:"question-o",class:"clickable",onClick:o[5]||(o[5]=_(i=>t(A)({message:e.$t("limitTotalAmountTips"),confirmButtonText:e.$t("confirm"),confirmButtonColor:"#3F80F7"}),["stop"])),color:"#999"})]),c(m,{class:"input-container",type:"number",modelValue:t(r).total_amount,"onUpdate:modelValue":o[7]||(o[7]=i=>t(r).total_amount=i),rules:[{required:!0,message:e.$t("pleaseEnter")}],center:"",clearable:"","input-align":"right",placeholder:e.$t("pleaseEnter")},{label:p(()=>[l("div",dt,[t(a).token?(y(),O(k,{key:0,class:"w-[20px] h-[20px] mr-5px",round:"","lazy-load":"",src:t(te)(t(a)),"error-icon":t(H)},null,8,["src","error-icon"])):oe("",!0),l("span",null,n(t(a).symbol||""),1)])]),button:p(()=>[l("button",{class:"text-14px color-#3F80F7 clickable",type:"button",onClick:o[6]||(o[6]=i=>t(r).total_amount=t(a).balance||0)},n(e.$t("max")),1)]),_:1},8,["modelValue","rules","placeholder"]),l("div",ft,[l("span",_t,n(e.$t("followUpPriceFluctuation")),1),c(s,{name:"question-o",class:"clickable",color:"#999",onClick:o[8]||(o[8]=_(i=>t(A)({message:e.$t("followUpPriceFluctuationTips"),confirmButtonText:e.$t("confirm"),confirmButtonColor:"#3F80F7"}),["stop"]))})]),l("div",vt,[l("button",{class:"clickable",onClick:o[9]||(o[9]=i=>M(0)),type:"button"},[c(s,{name:"minus",class:"btn-icon"})]),l("div",bt,[c(m,{style:{padding:"0",flex:"1"},modelValue:t(r).slippage,"onUpdate:modelValue":o[10]||(o[10]=i=>t(r).slippage=i),border:!1,"input-align":"right",label:"",placeholder:"50",type:"number"},null,8,["modelValue"]),gt]),l("button",{class:"clickable",onClick:o[11]||(o[11]=i=>M(1)),type:"button"},[c(s,{name:"plus",class:"btn-icon"})])])],64)),t(T)?(y(),O(C,{key:3,class:"submit-btn",type:"primary",color:"#999",block:"",loading:t(x),onClick:_(pe,["stop"])},{default:p(()=>[E(n(e.$t("cancelTerminateOrder")),1)]),_:1},8,["loading","onClick"])):(y(),O(C,{key:2,class:"submit-btn",type:"primary","native-type":"submit",block:"",loading:t(x),disabled:t(re)},{default:p(()=>[E(n(t(ie)||e.$t("followOrderImmediately")),1)]),_:1},8,["loading","disabled"]))]}),_:1}),l("div",Ft,[l("span",null,n(e.$t("IHaveOtherAwesomeAddresses"))+", ",1),l("button",{class:"clickable text-12px color-#3F80F7",type:"button",onClick:o[14]||(o[14]=_(h=>e.$router.push({name:"TraderCustom"}),["stop"]))},n(e.$t("customCopyOrder"))+" >",1)])]),c(_e,{show:t(w),"onUpdate:show":o[15]||(o[15]=h=>Z(w)?w.value=h:w=h),closeable:"",round:""},{default:p(()=>[l("div",At,[l("h3",Bt,n(e.$t("followOrderConfirm")),1),l("ul",Vt,[l("li",It,"1, "+n(e.$t("followOrderConfirmTips1")),1),l("li",Ot,"2, "+n(e.$t("followOrderConfirmTips2")),1),l("li",qt,"3, "+n(e.$t("followOrderConfirmTips3")),1),l("li",St,"4, "+n(e.$t("followOrderConfirmTips4",{amount:t(v)(t(I).tokenAmount,2),symbol:t(a).symbol,ethAmount:t(v)(t(I).ethAmount,2),uAmount:t(v)(t(I).uAmount,2),native:"ETH"})),1)]),c(C,{type:"primary",class:"max-h-36px",block:"",loading:t(x),onClick:_(de,["stop"])},{default:p(()=>[E(n(e.$t("confirmAndApprove")),1)]),_:1},8,["loading","onClick"])])]),_:1},8,["show"])])}}});const Lt=Ue(Ut,[["__scopeId","data-v-ee46314e"]]);export{Lt as default};
